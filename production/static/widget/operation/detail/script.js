"use strict";var accountId=common.urlTools.getUrlParam("accountId"),type=common.urlTools.getUrlParam("type");function bindEvents(){$("button.confirm").unbind().on("click",function(t){t.preventDefault(),"detail"==type?editOperationAccount():createOperationAccount()}),$("button.cancel").unbind().on("click",function(t){t.preventDefault(),window.location="./index.html?goto=operation&mold=list"})}function getAndRenderList(){if(accountId){var t={accountId:accountId};common.ajaxRequest("queryOperationAccountInfo",t,function(t){if(0==t.status)for(var e in t.data)if("status"==e){var o=t.data[e]&&"active"==t.data[e].toLowerCase()?1:2;$("input[value='"+o+"']").prop("checked",!0)}else"qq"==e&&""!=t.data.qq?($("option[value='qq]").prop("selected",!0),$("#contact").val(t.data.qq)):"skype"==e&&""!=t.data.skype?($("option[value=skype]").prop("selected",!0),$("#contact").val(t.data.skype)):"roleId"==e?$("select#roleId option[value='"+t.data.roleId+"']").prop("selected",!0):$("#"+e).val(t.data[e])})}}function checkInputs(){var t=$("#accountEmail").val();$("#contactName").val();return t&&/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)?!0:(common.msgs.new_msg("error","请检查账户邮箱"),void!1)}function editOperationAccount(){if(accountId){var t=$("form").serialize()+"&accountId="+accountId;common.ajaxRequest("editOperationAccount",t,function(t){0==t.status&&(common.msgs.new_msg("success","success"),window.location="./index.html?goto=operation&mold=list")})}}function createOperationAccount(){if(checkInputs()){var t=$("form").serialize();t=t+"&"+$("#searchChoice").val()+"="+$("#contact").val(),common.ajaxRequest("createOperationAccount",t,function(t){0==t.status&&(common.msgs.new_msg("success","success"),window.location="./index.html?goto=operation&mold=list")})}}function handleRoleId(t){switch(t){case 0:return"unknow";case 1:return"customer";case 2:return"admin";case 3:return"pm_creative_approval";case 4:return"pm_finance_operator";case 5:return"pm_finance_approval";case 6:return"AM";default:return""}}function queryRoleList(){var t="";common.ajaxRequest("queryRoleList",{},function(e){if(0==e.status){var o=e&&e.data&&e.data.list;$.each(o,function(e,o){o.roleId>1&&(t+='<option value="'+o.roleId+'">'+o.roleName+"</option>")}),$("#roleId").html(t)}})}function init(){queryRoleList(),"create"==type?($("form input, form select").removeAttr("disabled"),$("#accountId").prop("disabled",!0),$(".breadcrumb .active").text("新建账户"),$("form .form-group:first").addClass("hidden")):getAndRenderList(),bindEvents()}init();