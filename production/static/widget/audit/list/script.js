"use strict";function defaultResultMapper(e){return _.defaults(e,{accountId:null,accountName:null,adCount:null,approvalStatus:null,campaignId:null,campaignName:null,email:null,geoRunOnAlert:null,geoStatus:null,linkType:null,runOnAlert:null,status:null,tmtStatus:null,updateTime:null})}$(function(){$("#userInfomation").attr("approverId"),$("#userInfomation").attr("roleId");var e=t().status?"1":"";common.pluginsTools.loadPlugins(function(){template.helper("handleStatus",function(e){switch(e){case 1:return'<span class="label label-default">审核中</span>';case 2:return'<span class="label label-success">通过</span>';case 3:return'<span class="label label-danger">未通过</span>';case 4:return'<span class="label label-warning">部分通过</span>';default:return""}}),template.helper("status",function(e){switch(e){case 1:return'<span class="text-success"><i class="glyphicon glyphicon-play" /></span>';case 2:return'<span class="text-muted"><i class="glyphicon glyphicon-pause" /></span>';case 3:return'<span class="text-danger"><i class="glyphicon glyphicon-stop" /></span>';default:return""}}),template.helper("handleAdType",function(e){switch(e){case 1:return"横幅";case 2:return"原生";case 3:return"视频";case 4:default:return""}}),template.helper("alertIcon",function(e){return 0===e?'<span class="label label-danger" title="Alter"><i class="glyphicon glyphicon-exclamation-sign"></i></span>':'<span class="label label-ignore" title="Alter"><i class="glyphicon glyphicon-exclamation-sign"></i></span>'}),template.helper("runOnAlert",function(e){switch(e){case 1:return'<span class="label label-success" title="Ignore alter">Ignore</span>';default:return'<span class="label label-ignore" title="Ignore alter">Ignore</span>'}}),$("#list").on("click","button.detail",function(a){var t=$(this).attr("campaignId");localStorage.setItem("campaignId",t),s.val();var n=$.param({goto:"audit",mold:"detail",approvalStatus:s.val(),showClosed:e,campaignId:t});window.open("./index.html?"+n,"dsp-op-"+t),a.stopPropagation()}),$("#list").on("click","button.reason",function(e){var a=$(this).attr("campaignId"),t=$.param({qtime:"",qcamp:a,latest15:"查询最近15分钟"});window.open(window.filter_reason_host+"/filter_reason/?"+t),e.stopPropagation()}),$("#list").on("click","tr td:not(.actions)",function(){$(this).parent().find("button.detail").trigger("click")}),$("#reset").on("click",function(e){e.preventDefault(),e.stopPropagation(),$("#searchChoice").val("campaignId"),$("#inputSuccess4").val(""),!$("#approverId").prop("disabled")&&$("#approverId").val(""),$("#approval-status label:first").trigger("click")}),$("#inputSuccess4").on("keydown",function(e){var a=e.keyCode||e.which;"13"==a?(e.preventDefault(),n()):"27"==a&&($("#inputSuccess4").val(""),n())}),$("#search").on("click",function(e){e.preventDefault(),n()});var a=common.getUrlVars("userId");a&&($("#searchChoice").val("acUserId"),$("#inputSuccess4").val(a));$(".form_datetime, .form_date").datetimepicker({todayHighlight:1,pickerPosition:"bottom"}),n()},["template","datetimepicker"]),common.pluginsTools.loadCss("datetimepickerCss");var a=common.PageRender($(".page"),n);function t(){var e=$("#searchChoice").val(),a=$("#inputSuccess4").val();""!=a&&s.all();var t=$("form").serializeArray().reduce(function(e,a){return e[a.name]=a.value,e},{}),n={};return n[e]=a,$.extend(n,t)}function n(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=_.extend({},t(),l);for(var r in e=t().status?"1":"",_.defaults(s,{currentPage:1,status:"1,2",limit:50}),s)void 0!==s[r]&&""!==s[r]||delete s[r];n.require&&n.require.abort&&n.require.abort(),$("#list").html('<tr><td  class="text-center" colspan="10">Loading...</td></tr>'),(n.require=common.ajaxGet("querCampaignApproveList",s)).then(function(e){var t=void 0;0==e.status&&(t=e.data&&0==e.data.list.length?'<tr><td  class="text-center" colspan="10">No Result</td></tr>':template("materialsList",{data:e.data.list.map(defaultResultMapper)}),$("#list").html(t),a(e.data.paging)),e.status&&($("#list").html(""),a())})}var l,s=((l=$("#approval-status")).find("input").on("change",function(e){var a=l.find("label").not($(this).parent());setTimeout(function(){a.removeClass("active").removeClass("active").find("input").prop("checked",!1)},0),n()}),{val:function(){return l.find(" input:checked").val()},all:function(){l.find("label").removeClass("active").eq(0).addClass("active"),l.find("input").removeProp("checked").eq(0).prop("checked",!0)}})});