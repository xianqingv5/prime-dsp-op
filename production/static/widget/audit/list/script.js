"use strict";function defaultResultMapper(e){return _.defaults(e,{accountId:null,accountName:null,adCount:null,approvalStatus:null,campaignId:null,campaignName:null,email:null,geoRunOnAlert:null,geoStatus:null,linkType:null,runOnAlert:null,status:null,tmtStatus:null,updateTime:null})}$(function(){$("#userInfomation").attr("approverId"),$("#userInfomation").attr("roleId");var n=s().status?"1":"";common.pluginsTools.loadPlugins(function(){template.helper("handleStatus",function(e){switch(e){case 1:return'<span class="label label-default">审核中</span>';case 2:return'<span class="label label-success">通过</span>';case 3:return'<span class="label label-danger">未通过</span>';case 4:return'<span class="label label-warning">部分通过</span>';default:return""}}),template.helper("status",function(e){switch(e){case 1:return'<span class="text-success"><i class="glyphicon glyphicon-play" /></span>';case 2:return'<span class="text-muted"><i class="glyphicon glyphicon-pause" /></span>';case 3:return'<span class="text-danger"><i class="glyphicon glyphicon-stop" /></span>';default:return""}}),template.helper("handleAdType",function(e){switch(e){case 1:return"横幅";case 2:return"原生";case 3:return"视频";case 4:default:return""}}),template.helper("alertIcon",function(e){return 0===e?'<span class="label label-danger" title="Alter"><i class="glyphicon glyphicon-exclamation-sign"></i></span>':'<span class="label label-ignore" title="Alter"><i class="glyphicon glyphicon-exclamation-sign"></i></span>'}),template.helper("runOnAlert",function(e){switch(e){case 1:return'<span class="label label-success" title="Ignore alter">Ignore</span>';default:return'<span class="label label-ignore" title="Ignore alter">Ignore</span>'}}),$("#list").on("click","button.detail",function(e){var a=$(this).attr("campaignId");localStorage.setItem("campaignId",a),i.val();var t=$.param({goto:"audit",mold:"detail",approvalStatus:i.val(),showClosed:n,campaignId:a});window.open("./index.html?"+t,"dsp-op-"+a),e.stopPropagation()}),$("#list").on("click","button.reason",function(e){var a=$(this).attr("campaignId"),t=$.param({qtime:"",qcamp:a,latest15:"查询最近15分钟"});window.open(window.filter_reason_host+"/filter_reason/?"+t),e.stopPropagation()}),$("#list").on("click","tr td:not(.actions)",function(){$(this).parent().find("button.detail").trigger("click")}),$("#reset").on("click",function(e){e.preventDefault(),e.stopPropagation(),$("#searchChoice").val("campaignId"),$("#inputSuccess4").val(""),$("#approverId").prop("disabled")||$("#approverId").val(""),$("#approval-status label:first").trigger("click")}),$("#inputSuccess4").on("keydown",function(e){var a=e.keyCode||e.which;"13"==a?(e.preventDefault(),r()):"27"==a&&($("#inputSuccess4").val(""),r())}),$("#search").on("click",function(e){e.preventDefault(),r()});var e=common.getUrlVars("userId");e&&($("#searchChoice").val("acUserId"),$("#inputSuccess4").val(e));$(".form_datetime, .form_date").datetimepicker({todayHighlight:1,pickerPosition:"bottom"}),r()},["template","datetimepicker"]),common.pluginsTools.loadCss("datetimepickerCss");var l=common.PageRender($(".page"),r);function s(){var e=$("#searchChoice").val(),a=$("#inputSuccess4").val();""!=a&&i.all();var t=$("form").serializeArray().reduce(function(e,a){return e[a.name]=a.value,e},{}),n={};return n[e]=a,$.extend(n,t)}function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=_.extend({},s(),e);for(var t in n=s().status?"1":"",_.defaults(a,{currentPage:1,status:"1,2",limit:50}),a)void 0!==a[t]&&""!==a[t]||delete a[t];r.require&&r.require.abort&&r.require.abort(),$("#list").html('<tr><td  class="text-center" colspan="10">Loading...</td></tr>'),r.require=common.ajaxGet("querCampaignApproveList",a),r.require.then(function(e){var a=void 0;0==e.status&&(a=e.data&&0==e.data.list.length?'<tr><td  class="text-center" colspan="10">No Result</td></tr>':template("materialsList",{data:e.data.list.map(defaultResultMapper)}),$("#list").html(a),l(e.data.paging)),e.status&&($("#list").html(""),l())})}var t,i=((t=$("#approval-status")).find("input").on("change",function(e){var a=t.find("label").not($(this).parent());setTimeout(function(){a.removeClass("active").removeClass("active").find("input").prop("checked",!1)},0),r()}),{val:function(){return t.find(" input:checked").val()},all:function(){t.find("label").removeClass("active").eq(0).addClass("active"),t.find("input").removeProp("checked").eq(0).prop("checked",!0)}})});