"use strict";var _slicedToArray=function(a,t){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return function(a,t){var e=[],n=!0,r=!1,i=void 0;try{for(var l,c=a[Symbol.iterator]();!(n=(l=c.next()).done)&&(e.push(l.value),!t||e.length!==t);n=!0);}catch(a){r=!0,i=a}finally{try{!n&&c.return&&c.return()}finally{if(r)throw i}}return e}(a,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};$(function(){var a;common.pluginsTools.loadPlugins(function(){var e=1,n=common.getUrlVars("campaignId","approvalStatus","showClosed"),r=_slicedToArray(n,3),i=r[0],l=r[1],c=r[2],s="campaignId="+i+"&approvalStatus="+l+"&adStatus="+(c?"1,2,3":"");$("#adList").on("click","[check-all-ad]",function(){var a=$(this).parents(".ad-container:first");a.find(".platform-container input").prop("checked","checked")}),$("#adList").on("click","[apply-to-all]",function(){var a=$(this).parents(".ad-container:first"),t={};$("[platformId]",a).each(function(){var a=$(this).attr("platformId");t[a]=$(this).prop("checked")}),$("#adList").find(".ad-container [platformId]").each(function(){var a=$(this).attr("platformId");$(this).prop("checked",t[a])});var e=a.find(".ad-reason").val();return $("#adList").find(".ad-reason").val(e),!1}),$("#adList").on("click","[shield]",function(){var a=parseInt($(this).attr("shield"));$(this).parents(".ad-container:first").find(":checkbox[level]").prop("checked",!0).each(function(){var t=parseInt($(this).attr("level"));t<=a&&$(this).removeProp("checked")})}),$("button.submitAndExit").unbind().on("click",function(){var t,e;t=$("form").serializeArray().reduce(function(a,t){return a[t.name]=t.value,a},{}),e={approveAds:[],runOnAlert:"on"==t.runOnAlert?1:0,geoRunOnAlert:"on"==t.geoRunOnAlert?1:0},$(".ad-container").each(function(t){var n=$(this),r=n.attr("adId"),i=n.find(".ad-reason").val()||"",l=[],c=!(n.find("[platformId]").size()-n.find("[platformId]:checked").size());n.find("[platformId]:checked").each(function(a){l.push($(this).attr("platformId"))});var s=a.creativeList[t],o={adId:r,reason:i,approvedPlatform:l,bannerUrl:s.bannerUrl,iconUrl:s.iconUrl,picUrl:s.picUrl,videoUrl:s.videoUrl,html:s.html};c||""!=i||alert("[adID:"+r+"]审核未通过或部分通过的创意必须填写原因"),e.approveAds.push(o)})}),$("button.cancel").unbind().on("click",function(){window.location.href="index.html?goto=audit&mold=list"}),common.ajaxRequest("queryCampaignApproveInfo",s,function(n){if(0==n.status){document.title=n.data.campaignId+":"+n.data.campaignName+" | "+document.title;var r={};n.data.platforms.sort(function(a,t){return a.class>=t.class?1:-1}),n.data.platforms.forEach(function(a){r[t[a.class-1]]=r[t[a.class-1]]||[],r[t[a.class-1]].push(a)}),e=n.data.platforms[n.data.platforms.length-1].class,n.data.classGroup=r,n&&((i=n.data).countryWl=JSON.parse('{"0":'+i.countryWl+"}")[0].map(function(a){return a.name}),i.creativeList.forEach(function(a){a.approvedPlatform=JSON.parse(a.approvedPlatform)}),$("#campaignDetail").html(template("campaignDetailTmp",{data:i})),$("#adList").html(template("adListTmp",{adList:i.creativeList,campaign:i}))),a=n.data,function(a){var e=template.compile('\n            <%for(var i = 0; i < max; i++){%>\n                <a href="javascript:;" class="btn btn-primary" shield="<%= i + 1 %>"><%= LEVEL[i] %></a>\n            <%}%>');$("#shield-main").append(e({max:a,LEVEL:t}));var n=template.compile('\n            <%for(var i = 0; i < max; i++){%>\n                <a href="javascript:;" class="btn btn-default" shield="<%= i + 1 %>"><%= LEVEL[i] %></a>\n            <%}%>');$(".ad-container .tools").append(n({max:a,LEVEL:t}))}(e)}var i}),function(){template.helper("handleStatus",function(a){switch(a){case 1:return'<span class="label label-default">审核中</span>';case 2:return'<span class="label label-success">通过</span>';case 3:return'<span class="label label-danger">未通过</span>';case 4:return'<span class="label label-warning">部分通过</span>';default:return""}}),template.helper("campaignStatus",function(a){switch(a){case 1:return"Active";case 2:return"Paused";case 3:return"Deleted";default:return"Unknown"}}),template.helper("adStatus",function(a){switch(a){case 1:return"Active";case 2:return"Paused";case 3:return"Deleted";default:return"Unknown"}}),template.helper("tmt",function(a){return 0==a?'<span class="label label-danger">有报警！</span>':1==a?'<span class="label label-success">无报警</span>':2==a?'<span class="label label-default">扫描中</span>':void 0});var a={0:"不限",1:"移动网站流量",2:"移动应用流量"};template.helper("trafficType",function(t){var e=[];try{e=JSON.parse(t)}catch(a){}return!e.length&&(e=[0]),(e=_.map(e,function(t){return a[t]})).join(",")}),template.helper("parseInt",function(a){return parseInt(a)}),template.helper("forin",function(a,t){Object.keys(a).forEach(function(e){return t(a[e],e)})}),template.helper("linkType",function(a){return{1:"Banner",2:"Jstag",3:"Video",4:"Pop",5:"Pop prime",6:"Native"}[a]||"UNKNOWN"})}(),o=$(".shield"),o.on("click","a[shield]",function(){var a=parseInt($(this).attr("shield"));$("#adList :checkbox").prop("checked",!0),$("#adList").find(":checkbox[level]").each(function(){var t=parseInt($(this).attr("level"));t<=a&&$(this).removeProp("checked")})}),o.on("click","a[check-all]",function(){$("#adList :checkbox").prop("checked",!0)});var o},["template"]);var t="ABCDEFGHIJKL"});