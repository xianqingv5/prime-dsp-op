"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function __d(e,t,a){window[e]="@"===t[0]?a:t}window.api_host="/dsp-op",__d("prime_host","@Domain_name@","http://prime.yeahmobi.com"),__d("filter_reason_host","@filter_reason_host@","http://dsp-filter-reason-538930803.us-east-1.elb.amazonaws.com"),__d("_location","@Location@","2"),/(172\.20\.0\.39)|(dsp\.dev\.dy)/.test(location.href)&&(window.api_host="{api_host}",window.prime_host="{prime_host}"),window.Currency=2==_location?"$":"￥",moment.tz.add(["Asia/Shangshai|CST CDT|-80 -90|01010101010101010|-1c1I0 LX0 16p0 1jz0 1Myp0 Rb0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0|23e6","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","Etc/UTC|UTC|0|0|","Etc/GMT-8|+08|-80|0|"]),moment.tz.setDefault("Etc/UTC");var APIS={login:{baseURL:api_host+"/login",method:"POST"},logout:{baseURL:api_host+"/logout",method:"GET"},captcha:{baseURL:api_host+"/captcha",method:"GET"},queryApprovalList:{baseURL:api_host+"/queryApproverList",method:"GET"},queryApproverList:{baseURL:api_host+"/queryApproverList",method:"GET"},queryCreativeList:{baseURL:api_host+"/queryAdApproveList",method:"GET"},creativeInfo:{baseURL:api_host+"/queryAdApproveInfo",method:"GET"},approveCreative:{baseURL:api_host+"/approveAd",method:"POST"},queryAccountIdName:{baseURL:api_host+"/queryAccountIdName",method:"GET"},recharge:{baseURL:api_host+"/recharge",method:"POST"},refund:{baseURL:api_host+"/refund",method:"POST"},queryChargeInfo:{baseURL:api_host+"/queryChargeInfo",method:"GET"},financeApprovel:{baseURL:api_host+"/financeApprovel",method:"POST"},queryUserBalance:{baseURL:api_host+"/queryUserBalance",method:"GET"},queryAccountChargeHistory:{baseURL:api_host+"/queryAccountChargeHistory",method:"GET"},queryNextPendingChargeInfo:{baseURL:api_host+"/queryNextPendingChargeInfo",method:"GET"},queryOperationAccountList:{baseURL:api_host+"/queryOperationAccountList",method:"GET"},queryOperationAccountInfo:{baseURL:api_host+"/queryOperationAccountInfo",method:"GET"},createOperationAccount:{baseURL:api_host+"/createOperationAccount",method:"POST"},editOperationAccount:{baseURL:api_host+"/editOperationAccount",method:"POST"},queryRoleList:{baseURL:api_host+"/queryRoleList",method:"GET"},queryCustomerAccountList:{baseURL:api_host+"/queryCustomerAccountList",method:"GET"},queryCustomer:{baseURL:api_host+"/queryCustomer",method:"GET"},queryCustomerAccountInfo:{baseURL:api_host+"/queryCustomerAccountInfo",method:"GET"},approveCustomerAccount:{baseURL:api_host+"/approveCustomerAccount",method:"POST"},querCampaignApproveList:{baseURL:api_host+"/querCampaignApproveList",method:"GET"},queryCampaignApproveInfo:{baseURL:api_host+"/queryCampaignApproveInfo",method:"GET"},querAdExchange:{baseURL:api_host+"/querAdExchange",method:"GET"},batchApproveAd:{baseURL:api_host+"/batchApproveAd",method:"POST"}},libsPaths={template:"./static/libs/template/template.js",select2:"./static/libs/select2/dist/js/select2.min.js",datetimepicker:"./static/libs/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js",datetimepickerCss:"./static/libs/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css",eventproxy:"./static/libs/eventproxy/lib/eventproxy.js",highcharts:"./static/libs/highcharts/highcharts.js"},getset={},Query={_result:function(){},getAccounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return common.ajaxRequest("queryOperationAccountList",e,function(e){0==e.status&&t.resolve(e.data.list),t.reject()}),t},get Accounts(){return this.getAccounts()},get AMs(){return this.getAccounts({roleId:6})}},common={get:function(e){return getset[e]},set:function(e){$.extend(getset,e)},hash:function(){return $("meta[name=hash]").attr("content")||""},urlTools:{getUrlParam:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},urlRoute:function(e,t){var a="./static/widget/"+(e=e)+"/"+(t=t),o=common.hash();null==e||""==e?$("#content").html(""):($("#content").load(a+"/tpl.html?"+o),$("#customStyle").attr("href",a+"/style.css?"+o),$(".non-dropdown a").removeClass("active"),$("#"+e).addClass("active"),$.getScript({cache:!0,url:a+"/script.js?"+o}).done(function(e,t,o){console.log(" Triggered "+a+"/script.js success.")}).fail(function(e,t,o){console.log(" Triggered "+a+"/script.js Error")}))}},getChargeInfo:function(e){common.ajaxRequest("queryChargeInfo",e,function(e){e&&0==e.status&&common.renderfinanceApprovel(e)})},renderfinanceApprovel:function(e){for(var t in e.data)"chargeType"==t?$("#chargeType option[value='"+e.data.chargeType+"']").attr("selected",!0):"accountId"==t?$("#"+t).val(e.data.accountName+"(ID："+e.data.accountId+")"):$("#"+t).val(e.data[t]).text(e.data[t]),$("#approver").text(e.data.approver),$("#number").text(e.data.chargeId),$("#type").text(1==e.data.action?"充值审核":"退款审核")},renderCreativeInfo:function(e){var t=$(".inner"),a="",o=e&&e.data&&e.data.platforms,n=e&&e.data&&e.data.approvedPlatform,r=e&&e.data&&e.data.adType,i=e&&e.data&&e.data.adId;for(var s in $("input[name='adType']").val(r),$("input[name='adId']").val(i),$.each(o,function(e,t){a+='<label class="col-md-2"><input type="checkbox" name="approvedPlatform" value="'+t.id+'">'+(t.name?t.name:"")+"</label>"}),e&&e.data){if("adType"==s){var c=handleAdType(e.data[s]);$("#"+s).text(c)}else if("clickThroughUrl"==s){var d=(c=e.data.clickThroughUrl).replace(/\{[A-Z_0123456789]+\}/gi,1);$("#clickThroughUrl").text(c).attr("href",d)}else $("#"+s).text(e.data[s]);if(3==e.data.adType)$("#banner").addClass("hidden"),$("video").removeClass("hidden").attr("src",e.data.videoUrl),$("#video").attr("name","videoUrl").val(e.data.videoUrl);else if(2==e.data.adType){var u=e.data.iconUrl,l=e.data.picUrl;$("#icon").attr("name","iconUrl").val(u),$("#pic").attr("name","picUrl").val(l)}else{var p=e.data.bannerUrl;$("#bannerUrl").attr("src",p),$("#banner").attr("name","bannerUrl").val(p)}}t.html(a),$("#bannerUrl").attr("src",e.data.bannerUrl),$.each(n,function(e,t){$('input[value="'+t+'"').prop("checked",!0)})},getAuthorityAndSetLocation:function(e){switch(e){case 1:window.location="./index.html?goto=account&mold=list";break;case 2:case 3:window.location="./index.html?goto=audit&mold=list";break;case 4:case 5:window.location="./index.html?goto=finance&mold=list";break;case 6:window.location="./index.html?goto=account&mold=list";break;case 7:window.location="./index.html?goto=audit&mold=list";break;case 9:window.location="./index.html?goto=account&mold=list";break;default:window.location="./index.html"}},handleAuthority:function(e){var t=$("#finance"),a=$("#customer"),o=$("#audit"),n=$("#account"),r=$("#operation");switch(e){case"0":case"1":case"2":break;case"3":t.addClass("hidden"),n.addClass("hidden"),r.addClass("hidden"),a.addClass("hidden");break;case"4":case"5":n.addClass("hidden"),r.addClass("hidden"),o.addClass("hidden"),a.addClass("hidden");break;case"6":case"7":r.addClass("hidden")}},getNextPendingChargeInfo:function(){var e=common.urlTools.getUrlParam("mold"),t="chargeCheck"==e?1:2;common.ajaxRequest("queryNextPendingChargeInfo",{action:t},function(t){if(0==t.status)if(null!=t.data)common.renderfinanceApprovel(t);else{if("chargeCheck"==e)var a="充值信息";else a="退款信息";common.msgs.new_msg("warning","没有待审核的"+a),setTimeout(function(){window.location="./index.html?goto=finance&mold=list"},2e3)}})},getUserBalance:function(e,t){t=t;var a=0;common.ajaxRequest("queryUserBalance",{accountId:e},function(e){0==e.status&&(a=e&&e.data&&e.data.balance,t.removeClass("hidden").text(a))})},getAccountIdName:function(e,t){var a={};return void 0!==e&&Object.assign(a,{validStatus:e}),common.ajaxRequest("queryAccountIdName",a,function(e){var a='<option value="" selected>-请选择账户-</option>';if(0==e.status){var o=e&&e.data&&e.data.list;$.each(o,function(e,t){a+='<option value="'+t.accountId+'">'+t.accountName+" ( ID: "+t.accountId+" )</option>"})}t.html(a)})},countStartAndEnd:function(e,t,a){var o=a/2,n=e>o?1*e-o+1:1,r=e>o?1*e+o:a,i=t&&t.totalPage;return i<a&&(r=i),{start:n=(n=(r=r<=i?r:i)!=i?n:i-a+1)>1?n:1,end:r}},buildPage:function(e,t,a,o,n,r){n=n||10;var i=common.pluginsTools.getPath("template");if(t){r=r||1;var s=common.countStartAndEnd(r,t,n),c=s.start,d=s.end;$.getScript(i,function(){var i=template("tableListPage",{data:t,page:n,currentPage:r,start:c,end:d});e.html(i),$(".pageList",e).unbind().bind("click",a,function(e){var a=$(this).attr("data-value");common.countStartAndEnd(a,t,n),a&&"0"!=a&&(s=common.countStartAndEnd(r,t,n),c=s.start,d=s.end,o&&o(a,c,d))})})}},pluginsTools:{getPath:function(e){return libsPaths[e]},updateParams:function(){},loadPlugins:function(e,t){var a,o="function"==typeof e?e:null;t.length;t&&t.length?(a=$).when.apply(a,_toConsumableArray(t.map(function(e){var t=common.pluginsTools.getPath(e);return $.getScript(""+t)}))).done(function(){o&&o()}):o&&o()},loadCss:function(e){var t=common.pluginsTools.getPath(e);$("<link>").attr({rel:"stylesheet",type:"text/css",href:t}).appendTo("head"),console.log("path:"+t)},conveterParamsToJson:function(e){for(var t={},a=[],o=(e=e).split("&"),n=0;null!=o&&n<o.length;n++){var r=o[n].split("=");isNaN(r[1])||"password"==r[0]||"authCode"==r[0]||"comment"==r[0]||"reason"==r[0]||"bannerUrl"==r[0]||"videoUrl"==r[0]||"iconUrl"==r[0]||"picUrl"==r[0]||(r[1]=1*r[1]),"approvedPlatform"==r[0]?(a.push(r[1]),t[r[0]]=a):t[r[0]]=r[1]}return t}},ajaxPost:function(e,t){var a=APIS[e];return a||(a={baseURL:api_host+"/"+e}),$.ajax({timeout:6e4,url:a.baseURL,type:"POST",dataType:"json",contentType:"application/json",xhrFields:{withCredentials:!0},crossDomain:!0,data:JSON.stringify(t)})},ajaxGet:function(e,t){var a=APIS[e];return a||(a={baseURL:api_host+"/"+e}),$.ajax({timeout:6e4,url:a.baseURL,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,data:t})},ajaxRequest:function(e,t,a,o){if("object"!==_typeof(APIS[e]))return console.log("api not defined",!0),!1;var n="json";6==arguments.length&&arguments[5],5==arguments.length&&(n=arguments[4]);var r=APIS[e];o=o||function(){$('<div id="yt_overlay" class="yt_overlay" style="display: block;"><img src="./static/images/ajax_loader.gif" /></div>').appendTo("#content")};if("POST"==r.method){var i="application/json";t=decodeURIComponent(t.replace(/\+/g," "));t=JSON.stringify(common.pluginsTools.conveterParamsToJson(t))}var s={timeout:6e4,beforeSend:o,url:r.baseURL,type:r.method,dataType:n,contentType:i,xhrFields:{withCredentials:!0},success:function(e){0==e.status&&a&&a(e)},crossDomain:!0,data:t};return $.ajax(s)},globalErrorHandle:function(e,t,a,o,n,r){},msgs:{new_msg:function(e,t,a){t=t||"Unknow error occured.",e=e&&e.toLowerCase()||"error";var o=$("#content"),n=(a=a||function(){},$('<div class="alert alert-'+e+' "><a class="close" data-dismiss="alert">&times;</a><strong>'+e.toUpperCase()+": </strong> "+t+"</div>")),r=$(o).find(".alert");r&&r.remove(),$(o).prepend(n),n.delay(1e4).animate({height:0,opacity:0},{duration:300,complete:function(){$(this).remove(),a&&a()}})}},PageRender:function(e,t){return e.on("click","a",function(){if(!$(this).hasClass("disabled")){var e=$(this).attr("page");e&&t({currentPage:e})}}),function(a){return a?e.html(template("pageTemp",{pager:a})).find("select").on("change",function(){t({limit:$(this).val()})}):e.html("")}},getUrlVars:function(){for(var e,t=[],a=window.location.search.slice(1).split("&"),o=0;o<a.length;o++)e=a[o].split("="),t.push(e[0]),t[e[0]]=e[1];for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>1?[].concat(_toConsumableArray(r.map(function(e){return t[e]}))):1==r.length&&"string"==typeof r[0]?t[r]:t},appendStyle:function(e){var t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a)},permission:permission()};function permission(){var e=(localStorage.getItem("permissions")||"").split(","),t="true"==localStorage.getItem("permission-debug"),a=function(e,t){return e.split("|").reduce(function(e,a){return e||t.indexOf(a)>=0},!1)},o=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$("body");return $(o).find("[permission]").each(function(){var o,n=$(this).attr("permission");n=n.indexOf(",")>=0?n.split(","):[n],(o=n,function(e,t){return o.reduce(function(a,o){return a&&e(o,t)},!0)})(a,e)?$(this).attr("permission-resolved",n).removeAttr("permission").removeClass("hidden"):$(this).addClass(t?"permission-deny-debug":"permission-deny").removeAttr("permission").prop("disabled","disabled")})};o();var n,r=(n=$('<div class="permission-test hidden">').append("<button apply>应用</button>").append("<button mini>MIN</button>").append('<input type="checkbox" debug name="debug" '+(t?'checked="checked"':"")+'><label for="debug">debug</label>').append(["queryUserBalance","queryAccountIdName","financeApprovel","queryChargeInfo","queryAccountChargeHistory","queryNextPendingChargeInfo","recharge","refund","queryApproverList","queryCustomerAccountList","queryCustomerAccountInfo","approveCustomerAccount","queryOperationAccountList","queryOperationAccountInfo","createOperationAccount","editOperationAccount","queryRoleList","queryAdApproveList","queryAdApproveInfo","approveAd","querCampaignApproveList","queryCampaignApproveInfo","batchApproveAd","queryAdExchange","updateAdExchange","deleteAdExchange"].reduce(function(t,o){return t.append('<li><input name="permission" id="'+o+'" type="checkbox" '+(a(o,e)&&'checked="checked"')+' /> <label for="'+o+'">'+o+"</label></li>")},$("<ul>"))).on("click","button[apply]",function(){var e=n.find("input:checked").toArray().map(function(e){return $(e).attr("id")});localStorage.setItem("permissions",e.join(",")),localStorage.setItem("permission-debug",t),window.location.href=window.location.href}).on("click","button[mini]",function(){n.toggleClass("mini")}).find("[debug]").on("change",function(){t=$(this).prop("checked")}).end(),$("body").append(n),n),i=function(){return r.toggleClass("hidden")};return i.resolve=o,i.permissions=e,i.has=function(t){return a(t,e)},$("#main-navbar").on("dblclick","img:first",i),i}$(document).ajaxSuccess(function(e,t,a,o){"html"!==a.dataType&&"script"!==a.dataType&&($("body").find(".yt_overlay").fadeOut(function(){$(this).remove()}),0!=o.status&&403!=o.status&&1!=o.status?common.msgs.new_msg("error",o.msg):403==o.status?common.msgs.new_msg("error"," You do not have authority.",$("#content").html("")):1==o.status&&common.msgs.new_msg("error","Need Login",window.location="./login.html"))}),$.fn.extend({serializeJSON:function(){return $(this).serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{})},btnSubmiting:function(e){var t=$(this);t.val();return t.data("tmpVal",t.text()).text(e).prop("disabled",!0),_.debounce(function(){t.text(t.data("tmpVal")).removeData("tmpVal").removeProp("disabled")},1e3,!0)},loading:function(){var e=$(this).addClass("nor-loading");return function(){e.removeClass("nor-loading")}}}),$(document).ajaxComplete(function(e,t,a){"timeout"==a&&common.msgs.new_msg("error","连接超时"),console.log("http request end."),$("body").find(".yt_overlay").fadeOut(function(){$(this).remove()}),common.permission.resolve()});